<div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 16px; font-size: 15px; color: #374151;">
  <div style="text-align: center; margin-bottom: 16px;">
    <div style="display: inline-block; background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 6px 16px; border-radius: 50px; font-size: 12px; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase;"><%= @airline %> Fetch Failure</div>
  </div>

  <p style="margin: 0 0 12px 0; font-size: 14px;">
    The following <%= @failures.count %> fetch operation(s) failed for <strong><%= @airline %></strong>:
  </p>

  <% @failures.each_with_index do |failure, index| %>
    <div style="background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border-radius: 8px; padding: 10px 12px; margin-bottom: 8px; border: 1px solid #fecaca;">
      <table style="width: 100%; border-collapse: collapse;"><tr>
        <td style="vertical-align: middle;">
          <span style="font-weight: 600; font-size: 15px; color: #991b1b;">Error #<%= index + 1 %></span>
          <% if failure[:flight_search_id] %>
            <span style="font-size: 12px; color: #6b7280; margin-left: 4px;">Flight Search #<%= failure[:flight_search_id] %></span>
          <% end %>
        </td>
        <td style="text-align: right; vertical-align: middle;">
          <span style="background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%); color: #7f1d1d; padding: 3px 8px; border-radius: 4px; font-size: 12px; font-weight: 700;">FAILED</span>
        </td>
      </tr></table>

      <% if failure[:destination] %>
        <table style="width: 100%; border-collapse: collapse; margin-top: 6px;"><tr>
          <td style="vertical-align: middle;">
            <span style="color: #9ca3af; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;">Route:</span>
            <span style="color: #374151; font-size: 13px; font-weight: 500; margin-left: 4px;">RIX &rarr; <%= failure[:destination] %></span>
          </td>
          <% if failure[:dates] %>
            <td style="text-align: right; vertical-align: middle;">
              <span style="color: #9ca3af; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;">Dates:</span>
              <span style="color: #374151; font-size: 13px; font-weight: 500; margin-left: 4px;"><%= failure[:dates] %></span>
            </td>
          <% end %>
        </tr></table>
      <% end %>

      <div style="margin-top: 8px; padding: 8px; background: #fff; border-radius: 4px; border: 1px solid #fecaca;">
        <span style="color: #9ca3af; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; display: block; margin-bottom: 4px;">Error Message:</span>
        <span style="color: #dc2626; font-size: 13px; font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;"><%= failure[:error] %></span>
      </div>
    </div>
  <% end %>

  <div style="background: #f3f4f6; border-radius: 8px; padding: 10px 12px; margin-top: 16px;">
    <table style="width: 100%; border-collapse: collapse;"><tr>
      <td style="vertical-align: middle;">
        <span style="color: #6b7280; font-size: 12px;">Timestamp:</span>
        <span style="color: #374151; font-size: 12px; font-weight: 500; margin-left: 4px;"><%= @timestamp.strftime("%Y-%m-%d %H:%M:%S %Z") %></span>
      </td>
      <td style="text-align: right; vertical-align: middle;">
        <span style="color: #6b7280; font-size: 12px;">Environment:</span>
        <span style="color: #374151; font-size: 12px; font-weight: 500; margin-left: 4px;"><%= Rails.env %></span>
      </td>
    </tr></table>
  </div>

  <p style="color: #9ca3af; font-size: 12px; margin: 12px 0 0 0; text-align: center;">Tickets@Petrucho.me - System Alert</p>
</div>
