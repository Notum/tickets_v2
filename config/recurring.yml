# Recurring jobs configuration for Solid Queue
# See: https://github.com/rails/solid_queue#recurring-jobs

# Sync Ryanair destinations from RIX airport every hour
sync_ryanair_routes:
  class: SyncRyanairRoutesJob
  queue: default
  schedule: every hour

# Refresh all Ryanair flight prices every hour at :00
refresh_ryanair_prices:
  class: RefreshAllRyanairPricesJob
  queue: default
  schedule: every hour at minute 0

# Sync Bode.lv destinations every hour at :00
sync_bode_destinations:
  class: SyncBodeDestinationsJob
  queue: default
  schedule: every hour at minute 0

# Refresh all Bode.lv charter prices every hour at :00
refresh_bode_prices:
  class: RefreshAllBodePricesJob
  queue: default
  schedule: every hour at minute 0

# Sync AirBaltic destinations every hour at :30
sync_airbaltic_destinations:
  class: SyncAirbalticDestinationsJob
  queue: default
  schedule: every hour at minute 30

# Refresh all AirBaltic flight prices every hour at :00
refresh_airbaltic_prices:
  class: RefreshAllAirbalticPricesJob
  queue: default
  schedule: every hour at minute 0

# Sync Norwegian destinations twice daily (6:00 and 18:00)
# Also triggers dates prefetch after successful sync
sync_norwegian_destinations_morning:
  class: SyncNorwegianDestinationsJob
  queue: default
  schedule: every day at 6:00 Europe/Riga

sync_norwegian_destinations_evening:
  class: SyncNorwegianDestinationsJob
  queue: default
  schedule: every day at 18:00 Europe/Riga

# Refresh Norwegian flight prices hourly (for user's tracked flights)
refresh_norwegian_prices:
  class: RefreshAllNorwegianPricesJob
  queue: default
  schedule: every hour at minute 0

# Refresh FlyDubai flight prices hourly (RIX-DXB route only)
refresh_flydubai_prices:
  class: RefreshAllFlydubaiPricesJob
  queue: default
  schedule: every hour at minute 0

production:
  sync_ryanair_routes:
    class: SyncRyanairRoutesJob
    queue: default
    schedule: every hour

  refresh_ryanair_prices:
    class: RefreshAllRyanairPricesJob
    queue: default
    schedule: every hour at minute 0

  sync_bode_destinations:
    class: SyncBodeDestinationsJob
    queue: default
    schedule: every hour at minute 0

  refresh_bode_prices:
    class: RefreshAllBodePricesJob
    queue: default
    schedule: every hour at minute 0

  sync_airbaltic_destinations:
    class: SyncAirbalticDestinationsJob
    queue: default
    schedule: every hour at minute 30

  refresh_airbaltic_prices:
    class: RefreshAllAirbalticPricesJob
    queue: default
    schedule: every hour at minute 0

  # Sync Norwegian destinations twice daily (6:00 and 18:00)
  # Also triggers dates prefetch after successful sync
  sync_norwegian_destinations_morning:
    class: SyncNorwegianDestinationsJob
    queue: default
    schedule: every day at 6:00 Europe/Riga

  sync_norwegian_destinations_evening:
    class: SyncNorwegianDestinationsJob
    queue: default
    schedule: every day at 18:00 Europe/Riga

  # Refresh Norwegian flight prices hourly (for user's tracked flights)
  refresh_norwegian_prices:
    class: RefreshAllNorwegianPricesJob
    queue: default
    schedule: every hour at minute 0

  # Refresh FlyDubai flight prices hourly (RIX-DXB route only)
  refresh_flydubai_prices:
    class: RefreshAllFlydubaiPricesJob
    queue: default
    schedule: every hour at minute 0

  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12
